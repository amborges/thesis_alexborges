\section{Transcodificação Rápida por Herança de Particionamento de Blocos}
\label{cap:3.3}

Embora a predição interquadros seja o estágio de codificação que tradicionalmente requer o maior custo computacional em um codificador de vídeo, conforme podemos ver em \citet{bib:zrida_2011} e \citet{bib:siqueira_2020}, é possível observar, na Tabela \ref{tab:III} e na Tabela \ref{tab:IV}, que a reutilização de informações sobre o particionamento de bloco, também conhecida como herança de particionamento de bloco, é a abordagem mais comum empregada para acelerar a transcodificação de vídeo. A observação dessa preferencia de escolha se dá porque os estágios posteriores de codificação dependem significativamente do número de pixels que precisam ser processados, ou seja, do tamanho do bloco, o que possibilita a aplicação mais eficiente das técnicas de compressão e predição disponíveis nesse formato, resultando em uma relação ideal entre a compressão de dados e a qualidade de imagem. O processo que oferece essa distribuição da imagem em blocos é o particionamento de blocos, que funciona de forma iterativa em busca da melhor combinação de tamanhos e formatos de bloco para cada região da imagem. Em outras palavras, encontrar os melhores modos de codificação (ou seja,w modos de predição intraquadro, vetores de movimento em predição interquadros, modo de transformada, etc.) ocorre para cada tamanho de bloco candidato, o que significa que reduzir as opções de particionamento leva a uma redução do custo computacional geral de codificação em muitos níveis diferentes. Além disso, como a escolha do tamanho do bloco a ser utilizado depende mais do próprio conteúdo do vídeo do que do codificador em uso, a reutilização de informações de particionamento do processo de decodificação para o processo de codificação permite reduzir consideravelmente o custo de transcodificação, já que existe uma probabilidade mais elevada de que tamanhos de blocos similares sejam escolhidos para uma mesma região do vídeo.

Além disso, como na transcodificação homogênea o mesmo formato de codificação de vídeo é usado nos processos de decodificação e codificação, as decisões podem ser mapeadas de forma mais direta. No entanto, isso não é possível no caso de transcodificação heterogênea, pois não há correspondência garantida entre um modo observado no decodificador e sua aplicabilidade num codificador de formato diferente. Por esse motivo, desenvolver soluções para transcodificação heterogênea tende a ser mais desafiador do que para transcodificação homogênea, geralmente exigindo o uso de vários recursos adicionais que contribuem para a tomada de decisão.

Nas últimas décadas, com o aumento das resoluções de vídeo, dos recursos de rede e do poder computacional, novos padrões e formatos como H.266/VVC e AV1 trouxeram muito mais flexibilidade ao processo de particionamento, com tamanhos de blocos variando de 4$\times$4 a 128$\times$128 amostras, incluindo formatos quadrados e retangulares. Essa flexibilidade permite o uso das melhores ferramentas e dos melhores modos de codificação para cada tipo de conteúdo, o que leva a melhorias significativas na eficiência de compressão dos codecs modernos em relação aos seus antecessores. Nos formatos VP9, AV1, H.265/HEVC e H.266/VVC, os particionamentos de blocos são retratados por meio de uma árvore de particionamento recursiva \cite{bib:av1_overview_2021, bib:hevc, bib:vvc_partitioningStructure}, cuja nó-folha em cada profundidade representa um conjunto de blocos de formatos de dimensões semelhantes entre esses codificadores. A Tabela \ref{tab:V} apresenta um resumo das estruturas de particionamento, incluindo os tamanhos de blocos e os formatos de divisão disponíveis nos formatos de vídeo publicados mais recentemente.

\input{TABLES/tab_v.tex}

Algumas das soluções baseadas em aprendizado de máquina apresentadas na Tabela \ref{tab:IV} focam na redução da complexidade durante a decisão de particionamento de blocos. Esses trabalhos visam o transcodificador H.264/AVC-para-H.265/HEVC \cite{bib:holder_2009, bib:peixoto2_2014, bib:honrubia_2014, bib:peixoto3_2014, bib:huangyuan_2015, bib:honrubia_2015, bib:honrubia_2016, bib:correa_2016, bib:liu_2018, bib:xu_2019, bib:soares_2019}, o transcodificador VP9-to-H.265/HEVC \cite{bib:li_2017} e o H.265/HEVC-to-H.266/VVC \cite{bib:lucas_2020}. Além deles, propostas que não empregam técnicas de aprendizado de máquina, mas sim heurísticas, são encontradas na literatura. 

Um destes casos é \citet{bib:zhang_2012}, que propõe um transcodificador H.264/AVC-to-H.265/HEVC que usa os modos de predição e os vetores de movimento decodificados para inferir sobre as divisões de \textit{Coding Units} (CU) e a \textit{Prediction Units} (PU) no codificador H.265/HEVC. Outro é \citet{bib:franche_2015}, cujo transcodificador H.264/AVC-to-H.265/HEVC se baseia em trabalhos anteriores encontrados na literatura, mas, em vez de observar a ordenação \textit{up-down} do particionamento da CU (começando do bloco de tamanho maior para o de tamanho menor), avalia a ordenação \textit{bottom-up} da CU (ou seja, de baixo para cima) de forma a possibilitar um mapeamento mais direto entre o macrobloco H.264/AVC e a CU do H.265/HEVC. A solução de \citet{bib:franche_2015} também inclui um término antecipado do processo de particionamento, permitindo a inferência do modo de PU quando a profundidade de CU for menor que 1. O trabalho de \citet{bib:borges2_2021} expande um estratégia de transcodificação H.265/HEVC-para-AV1 proposta previamente em \citet{bib:borges_2019}, na qual a correlação estatística entre tamanhos de bloco de H.265/HEVC e AV1 é usada como base para limitar as profundidades da árvore de particionamento AV1. \citet{bib:borges_2021} propõem um transcodificador rápido de VP9 para AV1, que se baseia em uma análise estatística de tamanhos de blocos e de orientação dos blocos do VP9 de forma a inferir sobre as orientações dos blocos permitidos para serem aplicados no AV1. Neste trabalho, o parâmetro de quantização do AV1 é usado para permitir uma maior flexibilidade de particionamento do AV1, de acordo com a profundidade da árvore de particionamento observada no VP9. 

Por fim, algumas soluções visam desenvolver transcodificadores para adaptar \textit{bitstreams} para tecnologias mais antigas, como o trabalho de \citet{bib:tang_2015}, que propõe um transcodificador rápido de H.265/HEVC para H.264/AVC baseado em mapeamento direto de CUs e PUs em estruturas de macroblocos. \citet{bib:tang_2015} também emprega a reutilização de modos de predição intraquadro observados no processo de decodificação H.265/HEVC para acelerar a predição intra no H.264/AVC. Em relação à predição intraquadro, \citet{bib:tang_2015} sugere limitar a área de busca do H.264/AVC de acordo com os vetores de movimento obtidos da decodificação H.265/HEVC.

Portanto, fica claro que a reutilização de estruturas de particionamento tem sido amplamente empregada na comunidade de codificação de vídeo, inclusive como a principal estratégia para acelerar o processo de transcodificação, seja entre formatos dentro de uma mesma família (por exemplo, H.265/HEVC-para-H.266/VVC e VP9-para-AV1) seja entre diferentes famílias (por exemplo, H.265/HEVC-para-AV1). Embora esse tipo de estratégia seja mais facilmente aplicado para transcodificação homogênea (por exemplo, em \textit{transrating}), a maioria dos trabalhos nesta categoria visa acelerar soluções para transcodificação heterogênea.
