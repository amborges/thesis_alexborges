\chapter{Introdução}
\label{cap:1}

A tecnologia de captura e reprodução de vídeos foi inventada pelos irmãos Auguste Lumière e Louis Lumière, no final do ano de 1895 \cite{bib:lumiere}. No entanto, somente na década de 1970 foram desenvolvidas tecnologias de vídeos digitais \cite{bib:videocodechistory} e elas demandavam um elevado número de bits para armazenar o conteúdo capturado, o que trouxe consigo uma necessidade de redução deste volume de bits e, consequentemente,  do espaço de armazenamento necessário para armazená-los. Ou seja, os vídeos digitais exigiram a criação de compressores especializados em vídeo digitais.

Desde o lançamento do primeiro padrão de codificação de vídeo na década de 1980 (H.120 \cite{bib:h120}), o volume de conteúdo em vídeo tem crescido na sociedade, principalmente após a popularização de dispositivos móveis com capacidade de captura e reprodução de vídeos, em associação a melhorias na largura de banda da rede de internet, sendo que, atualmente, o conteúdo em vídeo é um dos tipos de mídia mais consumidos ao redor do mundo. Reuniões e aulas on-line, filmes e séries disponíveis em serviços de \textit{streaming}, jogos on-line e muitos outros são exemplos notórios da presença de conteúdo em vídeo no nosso dia a dia. Segundo \cite{bib:statista_2021}, no primeiro trimestre de 2019, 85\% de todos os dispositivos móveis do mundo acessaram algum conteúdo de vídeo on-line. Além disso, um relatório publicado em 2018 \cite{bib:statistaVideoTraffic} indicou que o conteúdo em vídeo foi responsável por 60\% de todo o tráfego de dados da internet. Estes autores preveem um crescimento desse tipo de conteúdo nos próximos anos, principalmente devido à popularização de vídeos em \textit{Ultra-High Definition} 4K (UHD4K), conforme apontado por \cite{bib:cisco_2020} e \cite{bib:bitmovin_report_2021}.

De fato, a pandemia de COVID-19 (SARS-CoV2 \cite{bib:covid19}) agravou esse cenário de crescimento, pois houve uma intensificação de campanhas de trabalhos remotos e aulas a distância, juntamente com o surgimento de novas distribuidoras de conteúdo digital, como Apple+, Disney+, HBO Max e muitas outras, como afirma \citet{bib:bitmovin_report_2020}, ocasionando um crescimento do consumo de conteúdo em vídeo digital de 30\% \cite{bib:ramirez_2020, bib:clapp_2021} a 300\% \cite{bib:bottger_2020} em todo o mundo. E, de acordo com \cite{bib:verizon_2021}, o tráfego de dados relacionados a jogos on-line cresceu 71\% nos primeiros meses da pandemia.

Desde a publicação do H.120 \cite{bib:h120}, em 1984, muitos outros formatos e padrões de codificação de vídeo foram publicados nas últimas quatro décadas, como mostra a Figura \ref{fig:1}. Alguns desses codificadores foram definidos por organizações mundiais como a Organização Internacional para Padronização (do inglês, \textit{International Organization for Standardization}, ISO), a Comissão Eletrotécnica Internacional (do inglês, \textit{International Electrotechnical Commission}, IEC) e a União Internacional de Telecomunicações (do inglês, \textit{International Telecommunication Union}, ITU). Outros formatos foram definidos por empresas e consórcios do setor, como o grupo \textit{Alliance for Open Media} (AOMedia), e, por não terem sido definidos por órgãos mundialmente reconhecidos, não podem receber a nomenclatura de padrão. Dentre os padrões de codificação, destacam-se os mais famosos: o H.262/MPEG-2 \cite{bib:mpeg2} e o H.264/AVC \cite{bib:h264overview2}. Enquanto o H.262/MPEG-2 foi amplamente utilizado para codificar vídeos para mídia de DVD, o H.264/AVC tem sido mais usado em conteúdos para a internet, contribuindo para a popularização do consumo de vídeos on-line. Inclusive, o padrão H.264/AVC é utilizado no Sistema Brasileiro de Televisão Digital \cite{bib:dissertacao_rodrigues_2008}. A Figura \ref{fig:1} mostra que a tecnologia de codificação de vídeo continuou evoluindo e, apesar do H.264/AVC ainda estar presente em 78\% do mercado mundial de vídeos, conforme \cite{bib:bitmovin_report_2022}, há quatro novos codificadores de vídeo que representam a tecnologia de ponta da atualidade: o \textit{AOMedia Video} 1 (AV1) \cite{bib:av1_overview_2021}, o \textit{Versatile Video Coding} (H.266/VVC) \cite{bib:vvc}, o \textit{MPEG-5 Essential Video Coding} (MPEG-5 EVC) \cite{bib:evc} e o \textit{Audio Video Standard Third Generation} (AVS3) \cite{bib:avs3}. Ainda na Figura \ref{fig:1} é possível observar diversos formatos e padrões de codificação de vídeo que foram publicados ao longo dos anos, com vários deles estando disponíveis para uso por parte da indústria e da população.

\include{FIGURES/fig_1.tex} 

No relatório publicado por \citet{bib:bitmovin_report_2021} em 2021, onde foram questionados representantes de diversas empresas atuantes na indústria de \textit{streaming} acerca da distribuição de uso dos codificadores de vídeo, foi possível identificar os principais formatos de codificação utilizados pela indústria. Nesta pesquisa, evidenciou-se que em uma mesma empresa pode utilizar mais de um codificador de vídeo ao mesmo tempo. Logo nenhuma soma de percentuais a seguir irá retornar 100\%. Os codificadores de vídeos mais usados em 2021, além do H.264/AVC \cite{bib:h264overview2} (78\%), foram: o H.265/HEVC \cite{bib:hevc} (49\%), o H.262/MPEG-2 \cite{bib:mpeg2} (31\%), o VP9 \cite{bib:vp9overview} (19\%), o VP8 \cite{bib:vp8} (16\%) e o AV1 \cite{bib:av1_overview_2021} (15\%). Os mesmos autores, em 2022, atualizaram o relatório \cite{bib:bitmovin_report_2022}, apontando que os cinco formatos mais utilizados pela indústria de \textit{streaming} são H.264/AVC (78\%), H.265/HEVC (40\%), H.266/VVC (19\%), VP8 (19\%) e AV1 (18\%). O estudo ainda indicou que os formatos H.265/HEVC e AV1 são os mais cotados para crescimento em 2023, com expectativa de expansão de uso em 43\% e 34\%, respectivamente. No entanto, é importante notar que os estudos não consideraram os formatos AVS1 \cite{bib:AVS}, AVS2 \cite{bib:avs2} e AVS3 \cite{bib:avs3}, amplamente utilizados na China \cite{bib:china_codecs}.

A maioria desses codificadores é capaz de atingir taxas de compressão acima de 99\%, o que é essencial para possibilitar a ampla implantação de sistemas multimídia e transmissão de vídeo pela internet. No entanto, além da taxa de compressão, diversas outras variáveis podem influenciar na decisão de qual codificador escolher, como o nível da qualidade de imagem, o tempo de processamento da codificação/decodificação, o consumo de energia requerido para utilizar o codificador e até mesmo licenciamento de propriedade intelectual. Assim, considerando a grande pluralidade de codificadores de vídeo disponíveis atualmente, a conversão entre formatos é necessária para permitir a compatibilidade entre eles.

Uma prática comum aplicada pela indústria de multimídia para obter essa compatibilidade é a utilização de transcodificadores de vídeo. Há muitas razões para alterar o formato de vídeo compactado, como converter arquivos de vídeo antigos para formatos novos e mais eficientes, fornecer compatibilidade entre gerações de dispositivos antigos com vídeos gerados sob novos formatos, adaptar a resolução de vídeo à exibição disponível ou a taxa de bits do vídeo para a largura de banda de internet disponível do usuário e muitos outros. Um exemplo do uso de transcodificador pode ser observado por dois dos principais serviços de \textit{streaming} de vídeo do mundo, o YouTube e a Netflix, que viabilizam a boa experiência ao usuário ao manter várias versões de um mesmo vídeo com diferentes taxas de bits e de resoluções em seus servidores. A criação dessas versões dos vídeos é feita através de um \textit{pipeline} de transcodificação \cite{bib:netflix_pipeline}.

Diferentes estratégias de transcodificação de vídeo podem ser encontradas na literatura, almejando prover a melhor experiência do usuário (do inglês, \textit{Quality of Experience}, QoE) e/ou a melhor qualidade de serviço (do inglês, \textit{Quality of Service}, QoS), especialmente quando há o envolvimento de transmissão de vídeo pela internet. Muitas dessas soluções visam acelerar a transcodificação, já que é um processo lento devido à alta complexidade dos codificadores de vídeo, principalmente os mais recentes, tal como demonstram \citet{bib:hevc_complexity} e \citet{bib:vvc_complexity}, assim como outros trabalhos recentes da literatura. Diferentes estratégias podem ser empregadas para reduzir essa complexidade, a depender do objetivo geral, tais como: reutilizar diretamente as decisões herdadas do formato bitstream anterior, por exemplo em \citet{bib:wang_2012} e \citet{bib:nguyen_2015}; treinar modelos de aprendizado de máquina para prever os melhores modos de codificação para o novo formato, como em \citet{bib:peixoto_2014}; ou mesmo predizer tamanhos de blocos a serem utilizadas em uma transcodificação de redimensionamento do tamanho da imagem, como em \citet{bib:lin_2016}. Embora muitas propostas tenham sido publicadas na literatura científica, em especial na última década, ainda há brechas a serem estudadas, principalmente quando se trata de novos formatos com maior poder de compressão de dados e elevada complexidade de execução.

Portanto, nesta tese de doutorado, apresentamos um levantamento bibliográfico acerca dos artigos de transcodificação de vídeo publicados entre os anos de 2011 e 2022. Com isso, é possível obter uma visão geral do estado da arte sobre transcodificação de vídeo, permitindo compreender o que vem sendo explorado nas pesquisas e identificar tópicos pouco abordados e desafios ainda em aberto na literatura vigente. Após essa abordagem, desenvolvemos propostas de transcodificação rápida de vídeo ao formato de vídeo \textit{AOMedia Video} 1 (AV1), a partir dos formatos VP8, VP9, H.264/AVC, H.265/HEVC e H.266/HEVC, cinco dos formatos de codificação de vídeo mais utilizados pela indústria de \textit{streaming} de vídeo, conforme já demonstrado por \citet{bib:bitmovin_report_2021} e \citet{bib:bitmovin_report_2022}.

Esta tese tem, como \textbf{objetivo geral}, o desenvolvimento de um \textit{pipeline} de processamento que possibilite a definição de transcodificadores rápidos de vídeo para o formato \textit{AOMedia Video} 1 (AV1) a partir de diversos outros formatos. Assim, a \textbf{hipótese} que norteou o desenvolvimento desta investigação foi a seguinte: \textit{a transcodificação de vídeo para o formato AV1 pode ser acelerada, com baixo impacto na eficiência de codificação, por meio do uso de uma metodologia comum para treinamento de modelos preditivos baseados em aprendizado de máquina, buscando inferir decisões na codificação a partir de dados extraídos tanto do bitstream original como do próprio processo de re-codificação}.

Ou seja, verificamos a possibilidade de que uma mesma metodologia de transcodificação de vídeo possa ser utilizada para acelerar diferentes transcodificadores e, mesmo assim, obter resultados de aceleração e impacto na eficiência de codificação similares aos demais trabalhos observados na literatura, que empregam metodologias variadas.

As principais contribuições científicas, tecnológicas e bibliográficas desta tese para a área de codificação de vídeo são:

\begin{itemize}
    \item Uma revisão bibliográfica da literatura da última década sobre transcodificação rápida de vídeo, possibilitando compreender as áreas de interesse e os resultados médios esperados pelos trabalhos de transcodificação rápida;

    \item Uma análise do processo de particionamento de blocos do software de referência do formato AV1, possibilitando compreender a complexidade das decisões tomadas pelo software \textit{libaom} e o impacto das decisões na eficiência de codificação;

    \item Dois transcodificadores rápidos de H.265/HEVC para AV1: o primeiro baseado em heurísticas \cite{bib:borges2_2021} e o segundo baseado em modelos preditivos gerados por algoritmos de aprendizado de máquina;

    \item Dois transcodificadores rápidos de VP9 para AV1: o primeiro baseado em heurísticas \cite{bib:borges_2021} e o segundo baseado em modelos preditivos gerados por algoritmos de aprendizado de máquina;

    \item Três transcodificadores rápidos inéditos na literatura científica, VP8-para-AV1, H.264/AVC-para-AV1 e H.266/VVC-para-AV1, todos eles baseados em modelos preditivos gerados por algoritmos de aprendizado de máquina;

    \item Um \textit{pipeline} de processamento automatizado para geração de modelos preditivos gerados por aprendizado de máquina que auxiliam na aceleração de transcodificadores de vídeo.
\end{itemize}

Para expor o trabalho desenvolvido, dividimos esta tese em sete capítulos. O capítulo \ref{cap:2} aborda os conceitos básicos necessários para a compreensão do restante do texto. O capítulo \ref{cap:3} trata da metodologia para revisão sistemática da literatura e dos resultados obtidos nesta etapa. O capítulo \ref{cap:4} descreve a metodologia geral aplicada para desenvolvimento das soluções propostas nesta tese, como sequências de vídeo e softwares utilizados. O capítulo \ref{cap:5} apresenta um estudo sobre a complexidade do codificador de vídeo AV1. O capítulo \ref{cap:6} apresenta duas soluções de transcodificação rápida baseadas em heurísticas e discute os resultados obtidos. O capítulo \ref{cap:7} apresenta o desenvolvimento de transcodificadores rápidos baseados em modelos preditivos gerados por aprendizado de máquina, descreve o \textit{pipeline} de processamento desenvolvido para esse fim e discute os resultados obtidos. Por fim, o capítulo \ref{cap:conclusao} apresenta as conclusões desta tese de doutorado.
